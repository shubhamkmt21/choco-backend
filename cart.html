<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | Choco Blossom India</title>
    <link rel="icon" href="logo.png" type="image/png">
    <link rel="stylesheet" href="./style.css?v=1.1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .checkout-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 0;
            min-height: 70vh;
            margin-top: 80px;
            /* Clear fixed header */
        }

        .checkout-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }

        .checkout-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 2px;
            background: #eee;
            z-index: 0;
        }

        .step {
            position: relative;
            z-index: 1;
            text-align: center;
            background: #fff;
            padding: 0 10px;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #eee;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            font-weight: bold;
            transition: 0.3s;
        }

        .step.active .step-circle {
            background: var(--color-primary);
            color: #fff;
        }

        .step.completed .step-circle {
            background: #4CAF50;
            color: #fff;
        }

        .step-label {
            font-size: 0.8rem;
            color: #999;
        }

        .step.active .step-label {
            color: var(--color-primary);
            font-weight: 600;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            font-family: inherit;
        }

        /* Summary Card */
        .summary-card {
            background: #fff;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .item-row,
        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            color: #555;
        }

        .summary-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--color-primary);
        }

        /* Success Animation */
        .success-view {
            text-align: center;
            padding: 3rem 1rem;
            animation: fadeIn 0.5s;
        }

        .check-icon {
            font-size: 4rem;
            color: #4CAF50;
            margin-bottom: 1.5rem;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
            }

            70% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        .fade-enter-active,
        .fade-leave-active {
            transition: opacity 0.3s;
        }

        .fade-enter-from,
        .fade-leave-to {
            opacity: 0;
        }

        /* Premium Enhancements */
        .summary-card {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.08);
            transition: transform 0.2s;
        }

        .summary-card:hover {
            transform: translateY(-2px);
        }

        .shiprocket-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 5px;
            box-shadow: 0 2px 5px rgba(118, 75, 162, 0.3);
        }

        .delivery-info {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin-top: 5px;
            font-size: 0.85rem;
            border-left: 3px solid var(--color-secondary);
        }

        .payment-option-label {
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid #eee;
            padding: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
        }

        .payment-option-label:hover {
            border-color: var(--color-primary);
            background: #fffcf5;
        }

        input[type="radio"]:checked+span {
            font-weight: bold;
            color: var(--color-primary);
        }

        /* Cart Item Styles */
        .cart-item {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            background: #fff;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 1px solid #eee;
        }

        .cart-item img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            flex-shrink: 0;
            border: 1px solid #eee;
        }

        .item-details {
            flex: 1;
        }

        .item-title {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--color-primary);
        }

        .item-price {
            color: var(--color-secondary);
            font-weight: 600;
            margin-bottom: 0.8rem;
        }

        .quantity-controls {
            display: inline-flex;
            align-items: center;
            background: #f5f5f5;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: bold;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:hover {
            color: var(--color-primary);
            background: #eee;
        }

        .quantity-controls span {
            width: 30px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .remove-btn {
            color: #ff4444;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            opacity: 0.7;
            transition: 0.2s;
        }

        .remove-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        /* Layout Fixes */
        .cart-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .cart-grid {
                grid-template-columns: 1fr;
            }

            .cart-item img {
                width: 80px;
                height: 80px;
            }
        }

        /* --- NEW ANIMATIONS --- */

        /* 1. Moving Chocolate Stepper */
        .choco-progress-bar {
            position: absolute;
            top: 25px;
            /* Aligns with step-circle center approx */
            left: 0;
            height: 4px;
            background: var(--color-primary);
            transition: width 0.5s ease;
            z-index: 0;
        }

        .moving-choco {
            position: absolute;
            top: 0;
            /* Adjust to sit on line */
            transform: translate(-50%, -50%);
            font-size: 2rem;
            transition: left 0.5s ease;
            z-index: 2;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2));
            animation: float 2s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(-50%, -60%);
            }

            50% {
                transform: translate(-50%, -40%);
            }
        }

        /* 2. Smiling Chocolate Success Character */
        .smiling-chocolate {
            width: 120px;
            height: 140px;
            background: linear-gradient(135deg, #5d4037 0%, #3e2723 100%);
            border-radius: 15px;
            position: relative;
            margin: 0 auto 30px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5), 0 10px 20px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            animation: bounceHappy 1s infinite alternate;
        }

        /* Chocolate Square Grid Pattern */
        .smiling-chocolate::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: linear-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            border-radius: 15px;
            opacity: 0.3;
        }

        .face {
            position: relative;
            z-index: 2;
            padding-top: 40px;
        }

        .eyes {
            display: flex;
            justify-content: space-around;
            padding: 0 20px;
        }

        .eye {
            width: 20px;
            height: 20px;
            background: #fff;
            border-radius: 50%;
            position: relative;
            animation: blink 4s infinite;
        }

        .eye::after {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            background: #3e2723;
            border-radius: 50%;
        }

        .mouth {
            width: 40px;
            height: 20px;
            border-bottom: 5px solid #fff;
            border-radius: 0 0 20px 20px;
            margin: 15px auto 0;
        }

        .cheeks {
            position: absolute;
            top: 65px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 15px;
        }

        .cheek {
            width: 15px;
            height: 10px;
            background: rgba(255, 100, 100, 0.3);
            border-radius: 50%;
        }

        @keyframes bounceHappy {
            from {
                transform: translateY(0);
            }

            to {
                transform: translateY(-10px);
            }
        }

        @keyframes blink {

            0%,
            96%,
            100% {
                transform: scaleY(1);
            }

            98% {
                transform: scaleY(0.1);
            }
        }

        /* ... existing styles ... */

        /* Payment UI Styles */
        .payment-methods-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .payment-option-card {
            border: 2px solid #eee;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            color: #555;
        }

        .payment-option-card:hover {
            background-color: #fafafa;
        }

        .payment-option-card.active {
            border-color: var(--color-primary);
            background-color: #fff8e1;
            color: var(--color-primary);
        }

        /* Visual Credit Card */
        .credit-card-visual {
            background: linear-gradient(135deg, #2D1B18, #5D4037);
            color: #fff;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card-chip {
            width: 50px;
            height: 35px;
            background: linear-gradient(135deg, #FFD700, #B8860B);
            border-radius: 6px;
            margin-bottom: 1rem;
        }

        .card-number-display {
            font-size: 1.4rem;
            letter-spacing: 2px;
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 1rem;
        }

        .card-details-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        /* QR Code Placeholder */
        .upi-qr-container {
            text-align: center;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px dashed #ddd;
        }

        /* Razorpay-style Checkout Theme */
        :root {
            --rp-blue: #3399cc;
            --rp-dark-blue: #182C4D;
            --rp-bg: #F4F6F8;
            --rp-border: #E0E4E8;
            --rp-text: #2B3D51;
            --rp-green: #36B37E;
        }

        .razorpay-container {
            background: #fff;
            border-radius: 6px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.15);
            max-width: 450px;
            margin: 2rem auto;
            overflow: hidden;
            font-family: 'Lato', -apple-system, sans-serif;
            color: var(--rp-text);
            position: relative;
        }

        .rp-header {
            background: var(--rp-dark-blue);
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rp-merchant-info h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .rp-merchant-info p {
            margin: 4px 0 0;
            font-size: 0.8rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .rp-amount {
            text-align: right;
        }

        .rp-amount .label {
            font-size: 0.7rem;
            opacity: 0.7;
            text-transform: uppercase;
        }

        .rp-amount .value {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .rp-body {
            display: flex;
        }

        .rp-sidebar {
            width: 100%;
            background: #fff;
        }

        .rp-method-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .rp-method-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--rp-border);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s;
            font-weight: 500;
            color: #515978;
        }

        .rp-method-item:hover {
            background: #F9FAFB;
        }

        .rp-method-item.active {
            background: #F4F8FF;
            color: var(--rp-blue);
            border-left: 4px solid var(--rp-blue);
        }

        .rp-content-area {
            padding: 1.5rem;
            background: #fff;
            animation: fadeIn 0.3s ease;
        }

        .rp-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #D3D8E1;
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 1rem;
            transition: border 0.2s;
        }

        .rp-input:focus {
            outline: none;
            border-color: var(--rp-blue);
            box-shadow: 0 0 0 2px rgba(51, 153, 204, 0.1);
        }

        .btn-razorpay {
            background: var(--rp-blue);
            color: white;
            border: none;
            width: 100%;
            padding: 14px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(51, 153, 204, 0.3);
            margin-top: 1rem;
        }

        .btn-razorpay:hover {
            background: #2b85b3;
        }

        .rp-alert {
            background: #FEF8E6;
            border: 1px solid #F6C874;
            color: #925810;
            padding: 12px;
            border-radius: 4px;
            font-size: 13px;
            margin-bottom: 1rem;
            display: flex;
            gap: 8px;
        }

        .rp-trusted-badge {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: #8D96A8;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #F0F0F0;
        }
    </style>
</head>

<body>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <p><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above ‚Çπ2500 via Shiprocket
            </p>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container navbar">
            <div class="logo"><a href="index.html"><img src="logo.png" alt="Choco Blossom Logo"></a></div>
            <nav class="nav-links">
                <a href="index.html">Home</a>
                <a href="about.html">Our Story</a>
                <a href="products.html">Collections</a>
                <div class="dropdown mega-dropdown">
                    <a href="products.html" class="dropbtn">Occasions <i class="fas fa-chevron-down"
                            style="margin-left: 6px; font-size: 0.7em;"></i></a>
                    <div class="mega-content">
                        <div class="mega-grid">
                            <!-- Column 1: Celebrations -->
                            <div class="mega-column">
                                <h4>Celebrations</h4>
                                <ul>
                                    <li><a href="products.html?category=Birthday">Birthday Gifts</a></li>
                                    <li><a href="products.html?category=Wedding">Wedding Gifts</a></li>
                                    <li><a href="products.html?category=Anniversary">Anniversary</a></li>
                                    <li><a href="products.html?category=Baby+Shower">Baby Shower</a></li>
                                    <li><a href="products.html?category=Baby+Announcement">Baby Announcement</a></li>
                                    <li><a href="products.html?category=House+Warming">House Warming</a></li>
                                </ul>
                            </div>

                            <!-- Column 2: Festivals -->
                            <div class="mega-column">
                                <h4>Festivals</h4>
                                <ul>
                                    <li><a href="products.html?category=Diwali">Diwali Gifts</a></li>
                                    <li><a href="products.html?category=Rakhi">Rakhi Gifts</a></li>
                                    <li><a href="products.html?category=Christmas">Christmas & New Year</a></li>
                                    <li><a href="products.html?category=Holi">Holi Gifts</a></li>
                                    <li><a href="products.html?category=Ramadan">Ramadan Gifts</a></li>
                                    <li><a href="products.html?category=Bhai+Dooj">Bhai Dooj</a></li>
                                </ul>
                            </div>

                            <!-- Column 3: Special Days -->
                            <div class="mega-column">
                                <h4>Special Days</h4>
                                <ul>
                                    <li><a href="products.html?category=Valentines">Valentine‚Äôs Day</a></li>
                                    <li><a href="products.html?category=Mothers+Day">Mother‚Äôs Day</a></li>
                                    <li><a href="products.html?category=Fathers+Day">Father‚Äôs Day</a></li>
                                    <li><a href="products.html?category=Womens+Day">Women‚Äôs Day</a></li>
                                    <li><a href="products.html?category=Kids">Kid's Gifts</a></li>
                                </ul>
                            </div>

                            <!-- Column 4: Collections -->
                            <div class="mega-column">
                                <h4>Collections</h4>
                                <ul>
                                    <li><a href="products.html?category=Bestsellers">Best Sellers</a></li>
                                    <li><a href="products.html?category=Corporate">Corporate Gifts</a></li>
                                    <li><a href="products.html?category=Dark">Dark Chocolates</a></li>
                                    <li><a href="products.html?category=Pick+Mix">Pick & Mix Gifts</a></li>
                                    <li><a href="products.html?category=Studio">Studio Creations</a></li>
                                    <li><a href="gift_cards.html">Gift Cards</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="corporate.html">Corporate Gifting</a>
                <a href="partners.html">Growth Partner</a>
                <a href="wedding.html">Wedding Gifts</a>
                <a href="contact.html">Contact Us</a>
            </nav>
            <div class="nav-icons">
                <a href="cart.html" class="cart-icon"><i class="fas fa-shopping-bag"></i><span
                        id="cart-count"></span></a>
            </div>
        </div>
    </header>

    <div id="checkout-app" class="container checkout-container">

        <!-- Step Indicators -->
        <div class="checkout-steps" v-if="step < 4">
            <!-- Animated Progress Line -->
            <div class="choco-progress-bar" :style="{ width: ((step - 1) / 2) * 100 + '%' }"></div>
            <!-- Walking Chocolate Character -->
            <div class="moving-choco" :style="{ left: ((step - 1) / 2) * 100 + '%' }">üç´</div>

            <div class="step" :class="{ active: step === 1, completed: step > 1 }" @click="step > 1 ? step = 1 : null"
                style="cursor: pointer;">
                <div class="step-circle"><i class="fas fa-check" v-if="step > 1"></i><span v-else>1</span></div>
                <div class="step-label">Cart</div>
            </div>
            <div class="step" :class="{ active: step === 2, completed: step > 2 }" @click="step > 2 ? step = 2 : null"
                style="cursor: pointer;">
                <div class="step-circle"><i class="fas fa-check" v-if="step > 2"></i><span v-else>2</span></div>
                <div class="step-label">Address</div>
            </div>
            <div class="step" :class="{ active: step === 3, completed: step > 3 }">
                <div class="step-circle"><i class="fas fa-check" v-if="step > 3"></i><span v-else>3</span></div>
                <div class="step-label">Payment</div>
            </div>
        </div>

        <!-- Step 1: Cart Items -->
        <div v-if="step === 1">
            <h2 style="margin-bottom: 1.5rem;">Shopping Cart</h2>
            <div v-if="cart.length === 0" class="text-center"
                style="padding: 3rem; background: #fff; border-radius: 8px;">
                <p>Your cart is empty.</p>
                <a href="products.html" class="btn btn-primary" style="margin-top: 1rem;">Shop Chocolates</a>
            </div>
            <div v-else class="cart-grid">
                <div class="cart-items">
                    <div v-for="item in cart" :key="item.id" class="cart-item">
                        <img :src="item.image" :alt="item.name"
                            onerror="this.src='https://placehold.co/100x100?text=No+Image'">
                        <div class="item-details">
                            <h4 class="item-title">{{ item.name }}</h4>
                            <div class="item-price">‚Çπ{{ item.price }}</div>
                            <div class="quantity-controls">
                                <button class="qty-btn" @click="updateQuantity(item.id, -1)"><i
                                        class="fas fa-minus"></i></button>
                                <span>{{ item.quantity }}</span>
                                <button class="qty-btn" @click="updateQuantity(item.id, 1)"><i
                                        class="fas fa-plus"></i></button>
                            </div>
                        </div>
                        <div class="remove-btn" @click="removeFromCart(item.id)" title="Remove Item"><i
                                class="fas fa-trash-alt"></i></div>
                    </div>
                </div>
                <div class="cart-summary summary-card">
                    <h3 style="margin-bottom: 1.5rem;">Cart Totals</h3>

                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span>‚Çπ{{ subtotal }}</span>
                    </div>

                    <div class="summary-row">
                        <span>Shipping</span>
                        <span style="font-size: 0.9rem; color: #666; font-style: italic;">Calculated at next step</span>
                    </div>

                    <div class="summary-total">
                        <span>Total</span>
                        <span>‚Çπ{{ subtotal }}</span>
                    </div>

                    <p style="font-size: 0.8rem; color: #777; margin: 0.5rem 0 1.5rem; text-align: right;">
                        (Excluding Shipping)
                    </p>

                    <button class="btn btn-primary" style="width: 100%;" @click="step = 2">
                        Proceed to Checkout <i class="fas fa-arrow-right" style="margin-left: 5px;"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Shipping Address -->
        <div v-if="step === 2">
            <h2 style="margin-bottom: 1.5rem;">Shipping Address</h2>
            <div class="cart-grid">
                <div class="summary-card">
                    <div class="form-grid">
                        <div class="form-group"><label>Full Name</label><input type="text" id="cust-name"
                                v-model="address.name" placeholder="John Doe"></div>
                        <div class="form-group"><label>Email</label><input type="email" id="cust-email"
                                v-model="address.email" placeholder="john@example.com"></div>
                    </div>
                    <div class="form-group"><label>Street Address</label><input type="text" v-model="address.street"
                            placeholder="123 Chocolate Lane"></div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>State</label>
                            <select v-model="address.state">
                                <option value="" disabled>Select State</option>
                                <option v-for="(cities, state) in indianStates" :key="state" :value="state">{{ state }}
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>City</label>
                            <select v-model="address.city">
                                <option value="" disabled>Select City</option>
                                <option v-for="city in availableCities" :key="city" :value="city">{{ city }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Pincode</label>
                            <div style="position: relative;">
                                <input type="text" id="pincode-input" v-model="address.pincode" maxlength="6"
                                    placeholder="400001" @input="calculateShipping" style="padding-right: 30px;">
                                <span v-if="isValidPin"
                                    style="position: absolute; right: 10px; top: 10px; color: green;"><i
                                        class="fas fa-check-circle"></i></span>
                            </div>
                            <!-- Shiprocket Feedback -->
                            <div v-if="deliveryDetails" class="delivery-info">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span><i class="fas fa-truck-fast"></i> <strong>{{ deliveryDetails.days
                                            }}</strong></span>
                                    <span class="shiprocket-badge"><i class="fas fa-rocket"></i> Shiprocket</span>
                                </div>
                                <div style="font-size: 0.75rem; color: #666; margin-top: 2px;">Fulfilled by Premium
                                    Courier</div>
                            </div>
                            <div v-else-if="address.pincode.length === 6"
                                style="color: red; font-size: 0.8rem; margin-top: 5px;">Checking availability...</div>
                        </div>
                        <div class="form-group"><label>Phone</label><input type="text" id="cust-phone"
                                v-model="address.phone" placeholder="9876543210"></div>
                    </div>

                    <div style="display: flex; justify-content: space-between; margin-top: 1rem;">
                        <button class="btn btn-outline" @click="step = 1">Back</button>
                        <button class="btn btn-primary" @click="proceedToPay">Proceed to Pay <i
                                class="fas fa-arrow-right"></i></button>
                    </div>
                    <p id="checkout-msg"
                        style="margin-top: 1rem; font-weight: bold; text-align: right; min-height: 1.5rem;"></p>
                </div>
                <!-- Mini Summary -->
                <div class="summary-card" style="height: fit-content;">
                    <h4>Order Summary</h4>
                    <p>{{ cart.length }} Items</p>
                    <div class="item-row"><span>Subtotal</span><span>‚Çπ{{ subtotal }}</span></div>
                    <div class="item-row"><span>Shipping</span><span :style="{color: shipping===0?'green':'inherit'}">{{
                            shipping === 0 ? 'Free' : '‚Çπ'+shipping }}</span></div>
                    <div class="summary-total"><span>Total</span><span>‚Çπ{{ total }}</span></div>
                </div>
            </div>
        </div>

        <!-- REMOVED OLD PAYMENT STEP (Step 3) -->

        <!-- Step 4: Success -->
        <div v-if="step === 4" class="success-view">
            <!-- Smiling Chocolate Animation -->
            <div class="smiling-chocolate">
                <div class="face">
                    <div class="eyes">
                        <div class="eye"></div>
                        <div class="eye"></div>
                    </div>
                    <div class="cheeks">
                        <div class="cheek"></div>
                        <div class="cheek"></div>
                    </div>
                    <div class="mouth"></div>
                </div>
            </div>

            <h1 class="liquid-reveal">Yum! Order Placed!</h1>
            <p style="font-size: 1.2rem; color: #666; margin-bottom: 2rem;">
                Sit back and relax. Your delicious chocolates are arriving soon! üööüí®
            </p>
            <p style="font-size: 1.2rem; color: #666; margin-bottom: 1rem;">Thank you, {{ address.name }}! Your
                chocolates are on the way.</p>
            <div
                style="background: #f9f9f9; display: inline-block; padding: 1rem 2rem; border-radius: 8px; margin-bottom: 2rem;">
                <p><strong>Order ID:</strong> {{ orderId }}</p>
                <p><strong>Transaction ID:</strong> {{ transactionId }}</p>
            </div>
            <div>
                <a href="index.html" class="btn btn-primary">Continue Shopping</a>
            </div>
        </div>

    </div>

    <!-- Newsletter -->
    <section class="section" style="background-color: var(--color-primary); color: #fff; margin-top: 4rem;">
        <div class="container text-center">
            <h2 style="color: var(--color-secondary);">Join the Club</h2>
            <p style="color: rgba(255,255,255,0.8); margin-bottom: 2rem;">Subscribe to receive updates, access to
                exclusive deals, and more.</p>
            <form style="max-width: 500px; margin: 0 auto; display: flex; gap: 10px;">
                <input type="email" placeholder="Enter your email address"
                    style="flex: 1; padding: 1rem; border: none; border-radius: 4px; outline: none;">
                <button type="submit" class="btn"
                    style="background: var(--color-secondary); color: var(--color-primary);">Subscribe</button>
            </form>
        </div>
    </section>

    <!-- Shipping Marquee -->
    <div class="shipping-marquee">
        <div class="marquee-content">
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
            <div class="marquee-item"><i class="fas fa-truck-fast"></i> Complimentary Pan-India Delivery on Orders Above
                ‚Çπ2500 via Shiprocket</div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="logo.png" alt="Choco Blossom"
                        style="width: 140px; margin-bottom: 1rem; border-radius: 8px;">
                    <p style="color: rgba(255,255,255,0.7);">Crafting memories with premium chocolates. Based
                        in Ahmedabad, delivering happiness nationwide.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/chocoblossomIndia/" target="_blank" class="social-icon"><i
                                class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/chocoblossomindia/" target="_blank" class="social-icon"><i
                                class="fab fa-instagram"></i></a>
                        <a href="https://www.youtube.com/@Choco-blossom" target="_blank" class="social-icon"><i
                                class="fab fa-youtube"></i></a>
                        <a href="https://www.linkedin.com/company/chocoblossom/" target="_blank" class="social-icon"><i
                                class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="products.html">Shop All</a></li>
                        <li><a href="about.html">Our Story</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>Customer Care</h4>
                    <ul class="footer-links">
                        <li><a href="shipping.html">Shipping Policy</a></li>
                        <li><a href="returns.html">Returns & Refunds</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="#">Track Order</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <ul class="footer-links">
                        <li style="color: rgba(255,255,255,0.8); display: flex; gap: 10px;">
                            <i class="fas fa-map-marker-alt" style="margin-top: 5px;"></i>
                            <a href="https://maps.app.goo.gl/Jihe6SA3eRXgMHd29" target="_blank"
                                style="color: inherit; text-decoration: none;">
                                <span>28, Saurasthra Society, Paldi, Ahmedabad, Gujarat 380007</span>
                            </a>
                        </li>
                        <li style="color: rgba(255,255,255,0.8);">
                            <a href="tel:+919227088688" style="color: inherit; text-decoration: none;">
                                <i class="fas fa-phone" style="width: 20px;"></i> +91 92270 88688
                            </a>
                        </li>
                        <li style="color: rgba(255,255,255,0.8);">
                            <a href="mailto:chocoblossom12@gmail.com" style="color: inherit; text-decoration: none;">
                                <i class="fas fa-envelope" style="width: 20px;"></i> chocoblossom12@gmail.com
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <div style="text-align: center;">
                    <p>&copy; 2026 Choco Blossom. All rights reserved.</p>
                    <p style="font-size: 0.85rem; margin-top: 0.2rem;">Based in Ahmedabad, Gujarat</p>
                </div>
                <div class="payment-icons">
                    <i class="fab fa-google-pay"></i>
                    <i class="fab fa-cc-visa"></i>
                    <i class="fab fa-cc-americanxpress"></i>
                    <i class="fab fa-cc-mastercard"></i>
                    <i class="fab fa-cc-paypal"></i>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="script.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    step: 1,
                    cart: [],
                    shipping: 0,
                    address: {
                        name: '', email: '', street: '', city: '', state: '', pincode: '', phone: ''
                    },
                    deliveryDetails: null,
                    isValidPin: false,
                    // Comprehensive List of Indian States & Cities
                    indianStates: {
                        "Maharashtra": ["Mumbai", "Pune", "Nagpur", "Nashik", "Aurangabad", "Thane", "Solapur"],
                        "Delhi": ["New Delhi", "North Delhi", "South Delhi", "East Delhi", "West Delhi"],
                        "Karnataka": ["Bangalore", "Mysore", "Hubli", "Mangalore", "Belgaum"],
                        "Gujarat": ["Ahmedabad", "Surat", "Vadodara", "Rajkot", "Gandhinagar"],
                        "Tamil Nadu": ["Chennai", "Coimbatore", "Madurai", "Tiruchirappalli", "Salem"],
                        "West Bengal": ["Kolkata", "Howrah", "Durgapur", "Asansol", "Siliguri"],
                        "Telangana": ["Hyderabad", "Warangal", "Nizamabad", "Karimnagar"],
                        "Rajasthan": ["Jaipur", "Jodhpur", "Udaipur", "Kota", "Bikaner"],
                        "Uttar Pradesh": ["Lucknow", "Kanpur", "Varanasi", "Agra", "Noida", "Ghaziabad"],
                        "Haryana": ["Gurgaon", "Faridabad", "Panipat", "Ambala", "Karnal"],
                        "Punjab": ["Chandigarh", "Ludhiana", "Amritsar", "Jalandhar", "Patiala"],
                        "Kerala": ["Kochi", "Thiruvananthapuram", "Kozhikode", "Thrissur", "Kollam"],
                        "Goa": ["Panaji", "Margao", "Vasco da Gama", "Mapusa"],
                        "Madhya Pradesh": ["Bhopal", "Indore", "Gwalior", "Jabalpur", "Ujjain"],
                        "Andhra Pradesh": ["Visakhapatnam", "Vijayawada", "Guntur", "Nellore", "Tirupati"],
                        "Odisha": ["Bhubaneswar", "Cuttack", "Rourkela", "Berhampur"],
                        "Bihar": ["Patna", "Gaya", "Bhagalpur", "Muzaffarpur"],
                        "Jharkhand": ["Ranchi", "Jamshedpur", "Dhanbad", "Bokaro"],
                        "Chhattisgarh": ["Raipur", "Bhilai", "Bilaspur", "Korba"],
                        "Assam": ["Guwahati", "Silchar", "Dibrugarh", "Jorhat"],
                        "Uttarakhand": ["Dehradun", "Haridwar", "Roorkee", "Haldwani"]
                    },
                    availableCities: []
                };
            },
            watch: {
                'address.state': function (newState) {
                    if (newState && this.indianStates[newState]) {
                        this.availableCities = this.indianStates[newState];
                        // Reset city if not in new state
                        if (!this.availableCities.includes(this.address.city)) {
                            this.address.city = '';
                        }
                    } else {
                        this.availableCities = [];
                    }
                }
            },
            computed: {
                subtotal() {
                    return this.cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                },
                total() {
                    return this.subtotal + this.shipping;
                }
            },
            mounted() {
                this.loadCart();
                window.renderCart = () => { };
                window.updateCartMetadata();
            },
            methods: {
                loadCart() {
                    this.cart = JSON.parse(localStorage.getItem('chocoCart')) || [];
                },
                saveCart() {
                    localStorage.setItem('chocoCart', JSON.stringify(this.cart));
                    window.updateCartMetadata();
                },
                updateQuantity(id, change) {
                    const item = this.cart.find(i => i.id === id);
                    if (item) {
                        item.quantity += change;
                        if (item.quantity <= 0) this.cart = this.cart.filter(i => i.id !== id);
                        this.saveCart();
                    }
                },
                removeFromCart(id) {
                    this.cart = this.cart.filter(i => i.id !== id);
                    this.saveCart();
                },
                calculateShipping() {
                    const pin = this.address.pincode;
                    this.deliveryDetails = null;
                    this.isValidPin = false;

                    if (pin.length === 6 && /^\d{6}$/.test(pin)) {
                        this.isValidPin = true;

                        // Auto-select State & City based on Pincode (Mock Logic)
                        const pinPrefix = pin.substring(0, 3);
                        // Simple Map for correct dropdown selection
                        const pinMap = {
                            '400': { s: 'Maharashtra', c: 'Mumbai' }, // Mumbai
                            '411': { s: 'Maharashtra', c: 'Pune' },   // Pune
                            '110': { s: 'Delhi', c: 'New Delhi' },    // Delhi
                            '560': { s: 'Karnataka', c: 'Bangalore' }, // Bangalore
                            '600': { s: 'Tamil Nadu', c: 'Chennai' },  // Chennai
                            '700': { s: 'West Bengal', c: 'Kolkata' }, // Kolkata
                            '500': { s: 'Telangana', c: 'Hyderabad' }, // Hyderabad
                            '380': { s: 'Gujarat', c: 'Ahmedabad' }    // Ahmedabad
                        };

                        if (pinMap[pinPrefix]) {
                            this.address.state = pinMap[pinPrefix].s;
                            this.$nextTick(() => {
                                this.address.city = pinMap[pinPrefix].c;
                            });
                        }

                        // Simulate API Call for Delivery Time
                        setTimeout(() => {
                            this.deliveryDetails = {
                                days: "2-3 Days Delivery",
                                courier: "BlueDart Express"
                            };
                            this.shipping = this.subtotal > 2500 ? 0 : 99; // Free shipping over 2500
                        }, 800);
                    }
                },
                proceedToPay() {
                    if (!this.address.name || !this.address.email || !this.address.street || !this.address.pincode || !this.address.phone || !this.address.state || !this.address.city) {
                        alert("Please fill in all address details.");
                        return;
                    }
                    if (!/^\d{10}$/.test(this.address.phone)) {
                        alert("Please enter a valid 10-digit phone number.");
                        return;
                    }

                    // Trigger Global Razorpay Logic
                    // We ensure DOM values are updated because v-model syncs instantly
                    if (window.placeOrder) {
                        window.placeOrder();
                    } else {
                        alert("Payment system loading... please try again.");
                    }
                }
            }
        }).mount('#checkout-app');
    </script>
</body>

</html>